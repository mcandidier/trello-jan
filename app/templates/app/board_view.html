{% extends 'app/base.html' %}

{% block content %}

<div class="list-group">
  <ul class="list-inline">
    <li class="list-inline-item"><a href="{% url 'home' %}"><h2>Home</h2></a></li>
    <li class="list-inline-item"><h5>{{ board.title }}</h5></li>
    <li class="list-inline-item">
      <form class="form-inline" method="post" novalidate>
        {% csrf_token %}
        {{ authorized_email.authorized_email }}
        <button class="btn btn-light my-2 my-sm-0 auth-email-btn" type="submit" >Submit</button>
      </form>
    </li>
    <li class="list-inline-item">
      <div class="dropdown">
        <button class="btn btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Members
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <a class="dropdown-item" href="#">{{board.user}} - (Admin)</a>
          {% for member in members %}
          <a class="dropdown-item" href="#">{{member.authorized_email}}</a>
          {% endfor %}
        </div>
      </div>
    </li>
    <li class="list-inline-item">
      {% for i in members_id%}
      {% if user_member %}
      <form method="POST" class="" id="leaveBoard" action="{% url 'leave_board' i.id %}" novalidate>
        {% csrf_token %}
        <input type="submit" value="Leave Board" class="save btn btn-light">
      </form>
      {% endif %}
    {% endfor %}
    </li>
  </ul>

  <ul class="row list-sort sortable-list">
  {% for list in lists %}

      <li class="col-md-2 list-frame drag-list" id="{{list.id}}" data-id="{{list.id}}">
        <div class="btn-group btn-list-title">
            <!-- Display List -->
            <div class="list-title">
              <a href="#" class="text-break btn btn-light content-btn-title-list">{{list.title}}</a>
            </div>
            <button type="button" class="btn btn-light fa fa-ellipsis-h content-btn-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <div class="dropdown-menu">
                <a class="dropdown-item" href="{% url 'delete_list' list.id %}">Delete</a>
                <a class="dropdown-item" href="{% url 'archive_list' list.id %}">Archive</a>
                <a class="dropdown-item" href="{% url 'list_edit' board.id list.id %}">Update</a>
            </div>
        </div>
        <!-- Display cards using ajax -->
        <!-- <div class="list_objects list-body" data-id="{{ list.id }}"></div> -->
        <ul class="sortable-card" id="{{list.id}}">
          <li class="card-spacer">&nbsp;</li>
          {% for card in list.card_set.all|dictsort:"id" %}
            {% if card.archive == True %}
              <li id="{{ card.id }}">
                  <div class="btn-group btn-card-title">
                      <!-- Display List -->
                      <div class="card-title">
                          <a href="#" class="text-break btn btn-light content-btn-card-list drag-card" data-id="{{ card.id }}" id="card{{ card.id }}" data-toggle="modal" data-target="#viewCardModal" data-remote="{% url 'show_cards' card.id %}">{{card.title}}</a>
                      </div>
                      <button type="button" class="btn btn-light fa fa-ellipsis-h btn-card-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      </button>
                      <div class="dropdown-menu">
                          <a class="dropdown-item" href="{% url 'delete_card' card.id %}">Delete</a>
                          <a class="dropdown-item" href="{% url 'archive_card' card.id %}">Archive</a>
                          <a class="dropdown-item" href="{% url 'card_edit' card.id %}">Edit</a>
                      </div>
                  </div>
              </li>
            {% endif %}
          {% endfor %}
          </ul>
        <a class="btn btn btn-light add-button" role="button" href="{% url 'card_new' list.id %}" class="top-menu"><i class="fa fa-plus" aria-hidden="true"></i> Add a card</a>
      </li>

      {% endfor %}
      <div class="col-md-2 add-btn-frame add-a-list" id="add-a-list">
        <a class="btn btn btn-light add-list-button add-a-list" role="button" href="{% url 'list_new' board.id %}" class="top-menu"><i class="fa fa-plus" aria-hidden="true"></i> Add a list</a>
      </div>
      
    </ul>
  </div>

 <!-- ajax link to input -->
  <!-- <a href="#" class="change">link</a> -->
 <!-- ajax link to input -->


<!-- Modals -->
<div class="modal fade btn" id="viewCardModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel"></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          ...
        </div>
      </div>
    </div>
</div>
<!-- Modal -->

{% endblock %}